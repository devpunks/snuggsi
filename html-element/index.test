const
  { test, serve }
    = require ('test')

const
  puppeteer
    = require ('puppeteer')


test ('new HTMLElement', async t => {

  const
    server
      = serve ``
  , browser
      = await puppeteer.launch ()
  , page
      = await browser.newPage ()
  , log
      = message =>
        console.log ( 'WHAAAT', message.args ()[1] )

  , console = message =>
      for (let i = 0; i < message.args ().length; ++i)
        console.log (`${i}: ${message.args ()[i]}`)


  await page
    .goto ('https://example.com')

//await page.content ()

  page.on ('console', console)


  page.evaluate
    (() => console.log('hello', 5, {foo: 'bar'}))


  await page
    .screenshot ({ path: 'screenshot.png' })

  await browser.close ()

  server.close ``
  t.end ()
})

