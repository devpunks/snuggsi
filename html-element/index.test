const
  { test, serve, browse }
    = require ('test')

const
  puppeteer
    = require ('puppeteer')


test ('new HTMLElement', async t => {

  const
    server
      = serve ``

  , URL
      = `http://localhost:${process.env.PORT}`

  , browser
      = await puppeteer.launch ``

  , page
      = await browser.newPage ``

  , log
      = messages =>
        messages
          .args ()
          .map  (message => console.warn (`${message}`))


  await page.goto
    (URL)

//for (let i of await page.$$('main'))
//  console.warn ('EYE', i)


  console.warn ('browser', (await browse))

  page.on ('console', log)

  page.evaluate
    (() => console.log('hello', 5, {foo: 'bar'}))

  await page
    .screenshot ({ path: 'screenshot.png', fullPage: true })

  server.close
    (await browser.close ``)

  t.end ()
})
