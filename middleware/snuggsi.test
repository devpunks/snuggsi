const
  { test, serve, read, fetch }
    = require ('test')


test ('calling next middlewaree')


test.only ('GET /snuggsi', async t => {

  const
    server = serve ``
  , dist   = read `dist/snuggsi.min.js`

  , options
      = { compress: false }

  , response
      = await fetch ('http://localhost:8181/snuggsi', options)

  , type
      = response.headers.get ('content-type')

  , body
      = await read (response.body)


  console.warn (response.headers)

  t.notOk (response.headers.get ('content-encoding'))
  t.ok (type.match (/application\/javascript/))
  t.ok (type.match (/charset=utf-8/))
  t.equal (body, dist)

  server.close ``
  t.end ()
})
