const
  { test, serve, read, fetch }
    = require ('test')


test ('calling next middleware')


test ('GET /', async t => {

  const
    server = serve `server/fixtures`
  , dist   = read  `server/fixtures/index.html`

  , headers = {
      'Accept-Encoding' : 'identity',
      'Accept'  : 'text/html;q=0.9, text/plain;q=0.6, */*;q=0.8'
    }

  , options
      = { compress: false, headers  }

  , resource = '/'
  , response
      = await fetch
          (`http://localhost:8181${resource}`, options)

  , type
      = response.headers.get ('content-type')

  , body
      = await read (response.body)

  t.notOk (response.headers.get ('content-encoding'))
//t.ok (type.match (/application\/javascript/))
//t.ok (type.match (/charset=utf-8/))
  t.equal (body, dist)

  server.close ``
  t.end ()
})
