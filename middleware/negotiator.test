const
  { test, serve, read, fetch }
    = require ('test')

, { Server }
    = require ('..')


test ('calling next middlewaree')


test ('GET / defaults to dist/snuggsi.min.js', async t => {

  const
    server = serve ``
  , dist   = read `dist/snuggsi.min.js`

  , options
      = { compress: false, headers: { 'Accept' : '*/*' } }

  , response
      = await fetch ('http://localhost:8181/', options)

  , type
      = response.headers.get ('content-type')

  , body
      = await read (response.body)


  t.notOk (response.headers.get ('content-encoding'))
  t.ok (type.match (/application\/javascript/))
  t.ok (type.match (/charset=utf-8/))
  t.equal (body, dist)

  server.close ``
  t.end ()
})
