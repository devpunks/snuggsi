const
  { test, serve, read, fetch }
    = require ('test')


test ('calling next middleware')


test ('GET /', async t => {

  const
    server = serve `server/fixtures`
  , dist   = read  `server/fixtures/index.html`

  , headers = {
      'Accept'  : 'text/html'
    , 'Accept-Encoding' : 'identity'
    }

  , resource = '/'
  , options  = { compress: false, headers  }
  , response = await fetch
      (`http://localhost:8181${resource}`, options)

  , body = await read (response.body)
  , type = response.headers.get ('content-type')


  t.notOk (response.headers.get ('content-encoding'))
//t.ok (type.match (/application\/javascript/))
//t.ok (type.match (/charset=utf-8/))
  t.equal (body, dist)

  server.close ``
  t.end ()
})
