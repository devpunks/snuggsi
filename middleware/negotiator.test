const
  { test, serve, read, fetch }
    = require ('test')


test ('calling next middlewaree')


test.only ('GET /', async t => {

  const
    server = serve ``
  , dist   = read `public/index.html`

  , options
//    = { compress: false, headers: { 'Accept' : '*/*' } }
      = { compress: false, headers  }

  , headers
      = { 'Accept' : 'application/ecmascript;q=0.9, */*;q=0.8', 'Accept-Encoding': 'identity' }

  , response
      = await fetch ('http://localhost:8181/index.html?debug', options)

  , type
      = response.headers.get ('content-type')

  , body
      = await read (response.body)

//console.warn (body)

  t.notOk (response.headers.get ('content-encoding'))
//t.ok (type.match (/application\/javascript/))
//t.ok (type.match (/charset=utf-8/))
  t.equal (body, dist)

  server.close ``
  t.end ()
})
