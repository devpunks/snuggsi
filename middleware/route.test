const
  { test, fetch, read }
    = require ('test')

, { route }
    = require ('.')

, { Server }
    = require ('..')


test.only ('route URI to middleware', async t => {

  const
    middleware
      = (context) =>
          (context.body = 'Shazam')
            && console.log ('From shazam', context)

  , stack
      = [ route ('/foo/', middleware) ]

  , server
      = (new Server (stack))
      .serve ``

  , response
      = await fetch ('http://localhost:8181/foo/')

  , body
      = await response.body

  , status = response.status


  console.log (status, await read (body))

  t.ok (true)

  server.close ``
  t.end ()
})
