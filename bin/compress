#!/usr/bin/env bash

# bro is installed locally and manually. No npm cli. HELP!
declare -r \
  BROTLI=brotli \
  ZOPFLI=zopfli \
  DIST=./dist \
  FILES=(snuggsi.min.es snuggsi.min.js)

echo -e"\n  ðŸƒ  Compressing â€¦"

for file in ${FILES[@]} ; do
  declare path=${DIST}/${file}

  echo -e "\n    ðŸŒ¿  $path"

  echo -e "\n        â˜˜ï¸  GZIP ðŸ‘‰  ${path}.gz"
  $ZOPFLI -v \
    --gzip \
    --i50 \
  $path

  echo -e "\n        ðŸ€  ZLIB ðŸ‘‰  ${path}.zlib"
  $ZOPFLI -v \
    --zlib \
    --i50 \
    $path

  echo -e "\n        ðŸ‚  DEFLATE ðŸ‘‰  $path.deflate"
  $ZOPFLI -v \
    --deflate \
    --i50 \
  $path

  echo -e "\n       ðŸŒ±  Brotli ðŸ‘‰  ${path}.br"
  $BROTLI \
    --best \
    --stdout \
    --verbose \
    $path \
  > $path.br

echo

done

