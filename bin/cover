#!/bin/bash

echo # NYC Test coverage
echo "snuggsi уГД Coverage: тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П тЪая╕П "
export INCLUDE="resource" # Included coverage files
export EXCLUDE="**/node_modules/**" # Excluded coverage files

echo "Including ЁЯСЙ  $INCLUDE"
echo "Excluding ЁЯСЙ  $EXCLUDE"
echo


./node_modules/.bin/nyc \
  --include=$INCLUDE    \
  --exclude=$EXCLUDE    \
  --extension=.es       \
  --reporter=text       \
  bin/test


export THRESHOLD=95       # Represented in Percentage
echo
echo "snuggsi уГД ЁЯУК  Coverage Check"
echo "  Threshold ЁЯСЙ  $THRESHOLD %"
echo

./node_modules/.bin/nyc     \
  check-coverage            \
    --lines      $THRESHOLD \
    --function   $THRESHOLD \
    --statements $THRESHOLD \
  bin/test

export CODE=$?

rm -rf .nyc_output/ # Remove output directory

exit $CODE
