#!/usr/bin/env bash

# https://gist.github.com/branneman/8775568
# https://gist.github.com/branneman/8048520
# https://stackoverflow.com/questions/10265798/determine-project-root-from-a-running-node-js-application

export PORT=8181
export NODE_PATH=`pwd`

BIN="$NODE_PATH/node_modules/.bin"
SPECS="$BIN/tap-spec"
TEST="$BIN/tape"


API="element"
ENTRY="index.test"
LIBRARIES=".,test,server,resource,middleware"
TESTS=$NODE_PATH/${1:-"{$LIBRARIES,$API}/$ENTRY"}


echo
echo "ðŸš¨  Testing, Testing, 1,2,3, ..."
echo
echo "  Entry ðŸ‘‰  $ENTRY"
echo "  Suite ðŸ‘‰  $TESTS"
echo


$TEST         \
  --require . \
$TESTS | $SPECS
