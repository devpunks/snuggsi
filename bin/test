#!/bin/bash

# Run tape

# https://stackoverflow.com/questions/10265798/determine-project-root-from-a-running-node-js-application
export ROOT=$(pwd)
export ENTRY="index.test"
#export PATHS="{test,middleware,elements}"
export PATHS="{test,elements}"
export FILES="./$PATHS/$ENTRY"

# https://gist.github.com/branneman/8775568
# https://gist.github.com/branneman/8048520
export NODE_PATH=$ROOT:$NODE_PATH

$ROOT/node_modules/.bin/tape \
  -r $ROOT/polyfills \
  -r $ROOT/test/index.es \
-- $FILES \
 | $ROOT/node_modules/.bin/tap-nyc
