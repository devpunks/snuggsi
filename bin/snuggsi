#!/usr/bin/env bash

set -u

clear
echo '
  ツツツツツツツツツツツツツツツツツツツ
  ツツツツツ                  ツツツツツ
  ツツツツツ    snuggsi ツ    ツツツツツ
  ツツツツツ                  ツツツツツ
  ツツツツツツツツツツツツツツツツツツツ
'
declare -x \
  COMMAND="${1:-help}" \
  SNUGGSI="$( npm config get prefix )/lib/node_modules/${BASH_SOURCE##*/}"

echo SNUGGSI 👉 $SNUGGSI
source $SNUGGSI/bin/.resources

function run () {
  local \
    command=${SNUGGSI}/bin/${1}

  echo Local command ${command}

  for resource in "${RESOURCES[@]}"
    do
      ( check $resource ) \
        && echo -e " 👉  📂  $resource ════════════════════\n\n" \
        && $command $resource
    done
} # run

function command () {
  echo

  # test ! -f $execute \
  #   || test ${execute##*/} == snuggsi \
  #   && echo -e "\n  🚫  NON EXECUTABLE COMMAND !\n\n" \
  #   && exit 1 # Short circuit execution

  # echo $execute
} # command

function check () {
  local \
    resource=$1

    test ! -e "$resource" \
      && echo "  🚫  RESOURCE NOT FOUND 👉 $resource\n\n" \
      && return 1

    return 0
} # check

run $COMMAND
