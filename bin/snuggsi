#!/usr/bin/env bash

# Shell Parameter Expansion
#  - https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html

# Bash string manipulations
#  - http://www.tldp.org/LDP/LG/issue18/bash.html

echo
echo "  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ "
echo "  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„                  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ "
echo "  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„     snuggsi ãƒ„   ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ "
echo "  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„                  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ "
echo "  ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ãƒ„ "


declare -r  ENTRY=`readlink $BASH_SOURCE`
declare -r  BIN=`dirname $BASH_SOURCE`
# https://stackoverflow.com/questions/6393551/what-is-the-meaning-of-0-in-a-bash-script
declare -rx SNUGGSI=$(cd $BIN/`dirname ${ENTRY%/*}`; pwd)
declare -r  COMMAND="$SNUGGSI/bin/$1"
declare -r  RESOURCES=("${@:2}")


function execute {
  local executable=$(basename $COMMAND)

  echo

  if test ! -f $COMMAND || test $executable == snuggsi
    then
      echo "ğŸ”´  Invalid command"
      echo
      exit 1
    fi

  echo "ğŸ“š  MOUNTING RESOURCES â€¦"
  printf ' ğŸ‘‰  ğŸ“  %s\n' "${RESOURCES[@]}"
  echo

  for RESOURCE in ${RESOURCES[@]}
    do
      if test -d $RESOURCE
        then
          echo " ğŸ‘‰  ğŸ“‚  $RESOURCE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          $COMMAND $RESOURCE
        else
          echo "ğŸ”´  $RESOURCE NOT A DIRECTORY"
      fi
    done

  echo
}


execute $COMMAND
